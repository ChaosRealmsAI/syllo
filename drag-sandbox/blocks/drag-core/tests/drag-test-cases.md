# 拖拽系统测试用例文档

## 一、功能点清单

### 1. 拖拽句柄显示/隐藏
- **功能描述**：鼠标悬停时显示拖拽句柄，离开时隐藏
- **交互细节**：
  - 鼠标进入块区域 → 句柄淡入显示
  - 鼠标离开块区域 → 句柄淡出隐藏
  - 句柄位于块左侧 46px 处

### 2. 左侧热区触发
- **功能描述**：块左侧60px范围内为热区，可触发句柄显示
- **交互细节**：
  - 鼠标在块左侧60px内移动 → 句柄显示
  - 热区不遮挡句柄本身的交互

### 3. 句柄hover高亮
- **功能描述**：鼠标悬停在拖拽句柄上时，对应块显示背景高亮
- **交互细节**：
  - 鼠标进入句柄 → 块背景变为 #f5f7fa
  - 鼠标离开句柄 → 背景恢复透明
  - 无蓝色底线（与拖拽中的指示线区分）

### 4. 拖拽开始状态
- **功能描述**：开始拖拽时的视觉反馈
- **交互细节**：
  - 按住句柄开始拖拽 → 被拖拽块透明度降至 30%
  - 光标变为 grabbing

### 5. 拖拽中的插入指示
- **功能描述**：拖拽过程中显示插入位置指示线
- **交互细节**：
  - 拖拽到目标块上半部分 → 显示蓝色线在块顶部
  - 拖拽到目标块下半部分 → 显示蓝色线在块底部
  - 指示线为 2px 蓝色 (#1677ff)

### 6. 拖拽重排序
- **功能描述**：完成拖拽后块的位置重新排列
- **交互细节**：
  - 释放鼠标 → 块移动到新位置
  - DOM 顺序实际改变
  - 触发 blocksReordered 事件

### 7. 拖拽成功动画
- **功能描述**：拖拽成功后的反馈动画
- **交互细节**：
  - 拖拽完成 → 被拖拽块显示浅蓝色背景 (#e6f4ff)
  - 背景保持 0.6 秒
  - 然后渐变消失，总时长 1.2 秒

## 二、测试用例

### TC001: 句柄显示隐藏测试
```
前置条件：页面加载完成，有多个可拖拽块
测试步骤：
1. 鼠标移动到第一个块上
2. 验证句柄显示
3. 鼠标移出块区域
4. 验证句柄隐藏
预期结果：
- 句柄在hover时显示，离开时隐藏
- 句柄位置正确（左侧-46px）
```

### TC002: 左侧热区测试
```
前置条件：页面加载完成
测试步骤：
1. 鼠标移动到块左侧空白区域（距离块边缘30px）
2. 验证句柄是否显示
3. 鼠标继续向左移动超出60px
4. 验证句柄是否隐藏
预期结果：
- 在60px热区内句柄显示
- 超出热区句柄隐藏
```

### TC003: 句柄hover高亮测试
```
前置条件：句柄已显示
测试步骤：
1. 鼠标悬停在句柄上
2. 验证块背景色变化
3. 鼠标离开句柄
4. 验证背景色恢复
预期结果：
- Hover时背景色为 #f5f7fa
- 离开后背景透明
- 无蓝色底线
```

### TC004: 拖拽状态测试
```
前置条件：句柄已显示
测试步骤：
1. 按住句柄开始拖拽
2. 验证被拖拽块透明度
3. 验证光标形状
预期结果：
- 块透明度降至30%
- 光标变为grabbing
```

### TC005: 插入指示线测试
```
前置条件：正在拖拽一个块
测试步骤：
1. 拖拽到另一个块的上半部分
2. 验证顶部指示线显示
3. 拖拽到下半部分
4. 验证底部指示线显示
预期结果：
- 上半部分显示顶部蓝线
- 下半部分显示底部蓝线
- 线条为2px蓝色
```

### TC006: 拖拽重排序测试
```
前置条件：有块A、B、C按顺序排列
测试步骤：
1. 拖拽块A到块C下方
2. 释放鼠标
3. 验证新顺序
预期结果：
- 顺序变为 B、C、A
- DOM结构实际改变
- 触发reorder事件
```

### TC007: 成功动画测试
```
前置条件：完成一次拖拽
测试步骤：
1. 观察被拖拽块的背景色
2. 等待1.2秒
3. 验证动画完成
预期结果：
- 立即显示浅蓝色背景
- 0.6秒后开始渐变
- 1.2秒后完全透明
```

### TC008: 连续拖拽测试
```
前置条件：多个块存在
测试步骤：
1. 拖拽块A到新位置
2. 立即拖拽块B到新位置
3. 验证两次拖拽都成功
预期结果：
- 两次拖拽独立完成
- 动画不相互干扰
```

### TC009: 拖拽取消测试
```
前置条件：开始拖拽
测试步骤：
1. 开始拖拽一个块
2. 按ESC键或拖到无效区域
3. 释放鼠标
预期结果：
- 块回到原位
- 无动画效果
```

### TC010: 边界测试
```
前置条件：有多个块
测试步骤：
1. 拖拽第一个块到第一个位置（无变化）
2. 拖拽最后一个块到最后位置（无变化）
3. 验证处理正确
预期结果：
- 位置不变时不触发动画
- 不产生错误
```

## 三、性能测试

### PT001: 大量块拖拽性能
```
前置条件：页面有50+个块
测试步骤：
1. 快速连续拖拽多个块
2. 监控页面响应
预期结果：
- 拖拽流畅，无卡顿
- FPS保持60
```

### PT002: 内存泄漏测试
```
前置条件：长时间运行
测试步骤：
1. 连续拖拽100次
2. 检查内存使用
预期结果：
- 内存稳定，无泄漏
- 事件监听器正确清理
```

## 四、兼容性测试

### CT001: 浏览器兼容性
```
测试环境：
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+
预期结果：
- 所有浏览器表现一致
```

### CT002: 触摸设备测试
```
测试环境：iPad、触屏笔记本
测试步骤：
1. 触摸长按触发拖拽
2. 手指移动进行拖拽
预期结果：
- 触摸交互正常工作
```

## 五、可访问性测试

### AT001: 键盘操作测试
```
测试步骤：
1. Tab键导航到块
2. 空格键选中
3. 方向键移动
4. Enter确认
预期结果：
- 纯键盘可完成拖拽
```

### AT002: 屏幕阅读器测试
```
测试步骤：
1. 开启屏幕阅读器
2. 执行拖拽操作
预期结果：
- 正确播报拖拽状态
- 播报新位置信息
```